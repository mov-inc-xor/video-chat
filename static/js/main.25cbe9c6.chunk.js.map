{"version":3,"sources":["../node_modules/peerjs/dist sync","components/ClipboardField.tsx","pages/StartPage.tsx","components/RoundSwitcher.tsx","redux/selectors.ts","redux/actionTypes.ts","redux/actions.ts","components/BottomPanel.tsx","components/LocalVideo.tsx","components/FullSizeVideo.tsx","components/ChatPanel.tsx","components/ChatSendPanel.tsx","hooks/useTextField.ts","components/Chat.tsx","components/ChatMessage.tsx","pages/MeetingPage.tsx","App.tsx","hooks/usePeer.ts","reportWebVitals.ts","redux/reducers/devices.ts","redux/reducers/stream.ts","redux/reducers/index.ts","redux/store.ts","index.tsx"],"names":["webpackEmptyContext","req","e","Error","code","keys","resolve","module","exports","id","ClipboardField","text","useState","snackbarOpened","setSnackbarOpened","handleClose","TextField","type","value","fullWidth","disabled","InputProps","endAdornment","InputAdornment","position","IconButton","aria-label","onClick","copy","edge","Snackbar","open","autoHideDuration","onClose","anchorOrigin","vertical","horizontal","message","action","size","color","fontSize","useStyles","makeStyles","theme","container","height","display","alignItems","justifyContent","paper","padding","spacing","marginTop","backdrop","zIndex","drawer","StartPage","peer","classes","backdropOpened","setBackdropOpened","remotePeerId","setRemotePeerId","CssBaseline","Container","maxWidth","className","Paper","variant","Grid","direction","item","Typography","gutterBottom","onChange","target","replaceAll","label","callUser","catch","reason","alert","finally","Backdrop","CircularProgress","RoundSwitcher","iconOn","iconOff","initialValue","toggle","isOn","setIsOn","getDevicesState","store","devices","isAudioEnabled","state","audio","isVideoEnabled","video","TOGGLE_AUDIO","TOGGLE_VIDEO","SET_LOCAL_STREAM","toggleAudio","toggleVideo","panel","bottom","backgroundColor","width","borderTop","connect","audioEnabled","videoEnabled","dispatch","toggleChatOpened","endCall","Box","justify","Divider","orientation","flexItem","top","objectFit","borderRadius","LocalVideo","React","forwardRef","props","ref","autoPlay","margin","FullSizeVideo","TabPanel","children","index","other","role","hidden","aria-labelledby","flexShrink","drawerPaper","overflow","drawerHeader","mixins","toolbar","chatTabPanel","flex","ChatPanel","useTheme","Drawer","anchor","box","paddingLeft","paddingTop","paddingBottom","paddingRight","ChatSendPanel","onSend","multiline","rowsMax","InputLabelProps","shrink","useTextField","setValue","error","setError","empty","trimValue","trim","setTimeout","clear","bind","chat","flexDirection","messagesContainer","overflowX","overflowY","Chat","messageTextField","m","ChatMessage","name","time","createStyles","main","root","localVideoRef","remoteVideoRef","chatOpened","setChatOpened","useEffect","setAudio","setVideo","sendMessage","messages","map","msg","fromID","App","useRef","peerRef","connRef","localStream","setId","speaking","setSpeaking","setMessages","generatedId","uuidv4","current","Peer","on","conn","data","call","navigator","mediaDevices","getUserMedia","then","stream","answer","remoteStream","srcObject","disconnect","peerId","Promise","reject","date","Date","hours","getHours","toString","minutes","getMinutes","length","currentTime","send","window","location","href","getAudioTracks","forEach","track","enabled","getVideoTracks","usePeer","reportWebVitals","onPerfEntry","Function","getCLS","getFID","getFCP","getLCP","getTTFB","initialState","payload","combineReducers","createStore","rootReducer","ReactDOM","render","StrictMode","document","getElementById"],"mappings":"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","file":"static/js/main.25cbe9c6.chunk.js","sourcesContent":["function webpackEmptyContext(req) {\n\tvar e = new Error(\"Cannot find module '\" + req + \"'\");\n\te.code = 'MODULE_NOT_FOUND';\n\tthrow e;\n}\nwebpackEmptyContext.keys = function() { return []; };\nwebpackEmptyContext.resolve = webpackEmptyContext;\nmodule.exports = webpackEmptyContext;\nwebpackEmptyContext.id = 110;","import { useState } from 'react'\nimport copy from 'clipboard-copy'\n\nimport {\n  InputAdornment,\n  IconButton,\n  TextField,\n  Snackbar,\n} from '@material-ui/core'\n\nimport FileCopyOutlinedIcon from '@material-ui/icons/FileCopyOutlined'\nimport CloseIcon from '@material-ui/icons/Close'\n\ntype ClipboardFieldProps = {\n  text: string\n}\n\nexport const ClipboardField = ({ text }: ClipboardFieldProps) => {\n  const [snackbarOpened, setSnackbarOpened] = useState<boolean>(false)\n\n  const copyToClipboard = () => {\n    copy(text)\n    setSnackbarOpened(true)\n  }\n\n  const handleClose = () => {\n    setSnackbarOpened(false)\n  }\n\n  return (\n    <>\n      <TextField\n        type='text'\n        value={text}\n        fullWidth={true}\n        disabled\n        InputProps={{\n          endAdornment: (\n            <InputAdornment position='end'>\n              <IconButton\n                aria-label='copy to clipboard'\n                onClick={copyToClipboard}\n                edge='end'\n              >\n                <FileCopyOutlinedIcon />\n              </IconButton>\n            </InputAdornment>\n          ),\n        }}\n      />\n\n      <Snackbar\n        open={snackbarOpened}\n        autoHideDuration={3000}\n        onClose={handleClose}\n        anchorOrigin={{\n          vertical: 'bottom',\n          horizontal: 'center',\n        }}\n        message='Скопировано'\n        action={\n          <IconButton\n            size='small'\n            aria-label='close'\n            color='inherit'\n            onClick={handleClose}\n          >\n            <CloseIcon fontSize='small' />\n          </IconButton>\n        }\n      />\n    </>\n  )\n}","import { useState } from 'react'\n\nimport {\n  Grid,\n  Paper,\n  Typography,\n  Container,\n  CssBaseline,\n  Backdrop,\n  CircularProgress,\n  TextField,\n  IconButton,\n} from '@material-ui/core'\n\nimport { makeStyles } from '@material-ui/core/styles'\nimport { ClipboardField } from '../components/ClipboardField'\nimport CallIcon from '@material-ui/icons/Call'\nimport { PeerHook } from '../hooks/usePeer'\n\nconst useStyles = makeStyles((theme) => ({\n  container: {\n    height: '100vh',\n    display: 'flex',\n    alignItems: 'center',\n    justifyContent: 'center',\n  },\n  paper: {\n    padding: theme.spacing(5),\n    marginTop: -theme.spacing(20),\n  },\n  backdrop: {\n    zIndex: theme.zIndex.drawer + 1,\n    color: '#fff',\n  },\n}))\n\ntype StartPageProps = {\n  peer: PeerHook\n}\n\nexport function StartPage({ peer }: StartPageProps) {\n  const classes = useStyles()\n\n  const [backdropOpened, setBackdropOpened] = useState<boolean>(false)\n\n  const [remotePeerId, setRemotePeerId] = useState<string>('')\n\n  const changeRemotePeerId = (e: React.ChangeEvent<HTMLInputElement>) => {\n    const text = e.target.value.replaceAll(' ', '')\n    setRemotePeerId(text)\n  }\n\n  const call = () => {\n    setBackdropOpened(true)\n    peer\n      .callUser(remotePeerId)\n      .catch((reason) => alert(reason))\n      .finally(() => setBackdropOpened(false))\n  }\n\n  return (\n    <>\n      <CssBaseline />\n      <Container maxWidth='sm' className={classes.container}>\n        <Paper className={classes.paper} variant={'outlined'}>\n          <Grid container spacing={2} direction={'column'}>\n            <Grid item>\n              <Typography variant='h5' gutterBottom>\n                Начните звонок\n              </Typography>\n\n              <TextField\n                value={remotePeerId}\n                onChange={changeRemotePeerId}\n                label='ID собеседника'\n              />\n\n              <IconButton color='primary' onClick={call}>\n                <CallIcon />\n              </IconButton>\n            </Grid>\n\n            <Grid item>\n              <Typography variant='overline' display='block' gutterBottom>\n                или поделитесь своим <b>ID</b>\n              </Typography>\n\n              <ClipboardField text={peer.id} />\n            </Grid>\n          </Grid>\n        </Paper>\n\n        <Backdrop className={classes.backdrop} open={backdropOpened}>\n          <CircularProgress color='inherit' />\n        </Backdrop>\n      </Container>\n    </>\n  )\n}\n","import React, {useState} from 'react'\nimport {IconButton} from \"@material-ui/core\"\n\ntype RoundSwitchProps = {\n  iconOn: React.ReactNode,\n  iconOff: React.ReactNode,\n  initialValue: boolean,\n  toggle: (() => void),\n}\n\nexport function RoundSwitcher({iconOn, iconOff, initialValue, toggle}: RoundSwitchProps) {\n\n  const [isOn, setIsOn] = useState<boolean>(initialValue)\n\n  const onClick = () => {\n    setIsOn(!isOn)\n    toggle()\n  }\n\n  return (\n    <IconButton color={isOn ? 'primary' : 'secondary'} onClick={onClick}>\n      {isOn ? iconOn : iconOff}\n    </IconButton>\n  )\n}","// export const getDevicesState = (store: any) => store.devices;\n\nexport const getDevicesState = (store: any) => {\n  return store.devices;\n}\n\nexport const isAudioEnabled = (store: any) => {\n  const state = getDevicesState(store);\n  return state ? state.audio : false;\n}\n\nexport const isVideoEnabled = (store: any) => {\n  const state = getDevicesState(store);\n  return state ? state.video : false;\n}\n\nexport const getLocalStream = (store: any) => {\n  return store.stream.localStream\n}","export const TOGGLE_AUDIO = 'TOGGLE_MICRO'\nexport const TOGGLE_VIDEO = 'TOGGLE_VIDEO'\nexport const SET_LOCAL_STREAM = 'SET_STREAM'","import {\n  TOGGLE_AUDIO,\n  TOGGLE_VIDEO,\n  SET_LOCAL_STREAM\n} from \"./actionTypes\";\n\nexport type Action = {\n  type: string,\n  payload?: any,\n}\n\nexport const toggleAudio = (): Action => ({\n  type: TOGGLE_AUDIO,\n});\n\nexport const toggleVideo = (): Action => ({\n  type: TOGGLE_VIDEO,\n});\n\nexport const setLocalStream = (stream: MediaStream): Action => ({\n  type: SET_LOCAL_STREAM,\n  payload: stream,\n})","import { makeStyles, Theme } from '@material-ui/core/styles'\nimport { Box, Divider, Grid, IconButton } from '@material-ui/core'\nimport { RoundSwitcher } from './RoundSwitcher'\nimport MicNoneOutlinedIcon from '@material-ui/icons/MicNoneOutlined'\nimport MicOffOutlinedIcon from '@material-ui/icons/MicOffOutlined'\nimport VideocamOutlinedIcon from '@material-ui/icons/VideocamOutlined'\nimport VideocamOffOutlinedIcon from '@material-ui/icons/VideocamOffOutlined'\nimport TextsmsOutlinedIcon from '@material-ui/icons/TextsmsOutlined'\nimport CallEndIcon from '@material-ui/icons/CallEnd'\nimport { isAudioEnabled, isVideoEnabled } from '../redux/selectors'\nimport { toggleAudio, toggleVideo } from '../redux/actions'\nimport { connect } from 'react-redux'\n\nconst useStyles = makeStyles((theme: Theme) => ({\n  panel: {\n    position: 'absolute',\n    bottom: 0,\n    padding: theme.spacing(1),\n    backgroundColor: 'white',\n    width: '100vw',\n    borderTop: '1px solid #eaeaea',\n  },\n}))\n\ntype BottomPanelProps = {\n  toggleChatOpened: () => void\n  audioEnabled: boolean\n  videoEnabled: boolean\n  toggleAudio: () => void\n  toggleVideo: () => void\n  endCall: () => void\n}\n\nfunction BottomPanel({\n  toggleChatOpened,\n  audioEnabled,\n  videoEnabled,\n  toggleAudio,\n  toggleVideo,\n  endCall,\n}: BottomPanelProps) {\n  const classes = useStyles()\n\n  return (\n    <Box className={classes.panel}>\n      <Grid container justify={'center'}>\n        <Grid item container alignItems={'center'} justify={'center'}>\n          <RoundSwitcher\n            iconOn={<MicNoneOutlinedIcon />}\n            iconOff={<MicOffOutlinedIcon />}\n            initialValue={audioEnabled}\n            toggle={toggleAudio}\n          />\n\n          <RoundSwitcher\n            iconOn={<VideocamOutlinedIcon />}\n            iconOff={<VideocamOffOutlinedIcon />}\n            initialValue={videoEnabled}\n            toggle={toggleVideo}\n          />\n\n          <Divider orientation='vertical' flexItem />\n\n          <IconButton color={'secondary'} onClick={endCall}>\n            <CallEndIcon />\n          </IconButton>\n\n          <IconButton color={'default'} onClick={toggleChatOpened}>\n            {/*<Badge color=\"secondary\" variant=\"dot\" invisible={false}>*/}\n            <TextsmsOutlinedIcon />\n            {/*</Badge>*/}\n          </IconButton>\n        </Grid>\n      </Grid>\n    </Box>\n  )\n}\n\nconst mapStateToProps = (state: any) => {\n  const audioEnabled = isAudioEnabled(state)\n  const videoEnabled = isVideoEnabled(state)\n\n  return { audioEnabled, videoEnabled, toggleAudio, toggleVideo }\n}\n\nconst mapDispatchToProps = (dispatch: any) => {\n  return {\n    toggleAudio: () => dispatch(toggleAudio()),\n    toggleVideo: () => dispatch(toggleVideo()),\n  }\n}\n\nexport default connect(mapStateToProps, mapDispatchToProps)(BottomPanel)\n","import React, { ForwardedRef } from 'react'\nimport { makeStyles } from '@material-ui/core/styles'\n\nconst useStyles = makeStyles((theme) => ({\n  video: {\n    height: '250px',\n    position: 'absolute',\n    top: '0',\n    objectFit: 'cover',\n    backgroundColor: '#263238',\n    borderRadius: '10px',\n  },\n}))\n\nexport const LocalVideo = React.forwardRef((props, ref: ForwardedRef<HTMLVideoElement>) => {\n  const classes = useStyles()\n  \n  return <video {...props} ref={ref} autoPlay className={classes.video} />\n})\n","import React, { ForwardedRef } from 'react'\nimport { makeStyles } from '@material-ui/core/styles'\n\nconst useStyles = makeStyles((theme) => ({\n  video: {\n    width: '100%',\n    height: '100%',\n    objectFit: 'cover',\n    backgroundColor: '#263238',\n    margin: 'auto',\n  },\n}))\n\nexport const FullSizeVideo = React.forwardRef((props, ref: ForwardedRef<HTMLVideoElement>) => {\n  const classes = useStyles()\n  \n  return <video {...props} ref={ref} autoPlay className={classes.video} />\n})\n","import React from 'react'\nimport IconButton from '@material-ui/core/IconButton'\nimport ChevronLeftIcon from '@material-ui/icons/ChevronLeft'\nimport ChevronRightIcon from '@material-ui/icons/ChevronRight'\nimport Divider from '@material-ui/core/Divider'\nimport { Drawer, Box } from '@material-ui/core'\nimport { makeStyles, Theme, useTheme } from '@material-ui/core/styles'\n\nexport const drawerWidth = 340\n\ntype TabPanelProps = {\n  children?: React.ReactNode\n  index: any\n  value: any\n  className?: string\n}\n\nfunction TabPanel(props: TabPanelProps) {\n  const { children, value, index, ...other } = props\n\n  return (\n    <div\n      role='tabpanel'\n      hidden={value !== index}\n      id={`simple-tabpanel-${index}`}\n      aria-labelledby={`simple-tab-${index}`}\n      {...other}\n    >\n      {value === index && children}\n    </div>\n  )\n}\n\nconst useStyles = makeStyles((theme: Theme) => ({\n  drawer: {\n    width: drawerWidth,\n    flexShrink: 0,\n  },\n  drawerPaper: {\n    width: drawerWidth,\n    overflow: 'hidden',\n  },\n  drawerHeader: {\n    display: 'flex',\n    alignItems: 'center',\n    padding: theme.spacing(0, 1),\n    ...theme.mixins.toolbar,\n    justifyContent: 'flex-start',\n  },\n  chatTabPanel: {\n    display: 'flex',\n    flex: '1',\n    overflow: 'hidden',\n  },\n}))\n\ntype ChatDrawerProps = {\n  open: boolean\n  onClose: () => void\n  children: React.ReactNode\n}\n\nexport function ChatPanel({ open, onClose, children }: ChatDrawerProps) {\n  const classes = useStyles()\n  const theme = useTheme()\n\n  return (\n    <Drawer\n      className={classes.drawer}\n      anchor='right'\n      open={open}\n      onClose={onClose}\n      classes={{\n        paper: classes.drawerPaper,\n      }}\n    >\n      <Box>\n        <div className={classes.drawerHeader}>\n          <IconButton onClick={onClose}>\n            {theme.direction === 'rtl' ? (\n              <ChevronLeftIcon />\n            ) : (\n              <ChevronRightIcon />\n            )}\n          </IconButton>\n        </div>\n        <Divider />\n      </Box>\n\n      <TabPanel value={0} index={0} className={classes.chatTabPanel}>\n        {children}\n      </TabPanel>\n    </Drawer>\n  )\n}","import { Box, IconButton, TextField } from '@material-ui/core'\nimport React, { ChangeEvent } from 'react'\n\nimport SendIcon from '@material-ui/icons/Send'\nimport { makeStyles, Theme } from '@material-ui/core/styles'\n\nconst useStyles = makeStyles((theme: Theme) => ({\n  box: {\n    // position: 'sticky',\n    display: 'flex',\n    // bottom: 0,\n    backgroundColor: 'white',\n    borderTop: '1px solid #eaeaea',\n    width: '100%',\n    paddingLeft: theme.spacing(2),\n    paddingTop: theme.spacing(1),\n    paddingBottom: theme.spacing(1),\n    paddingRight: theme.spacing(1),\n  },\n}))\n\ntype ChatSendPanelProps = {\n  value: string\n  onChange: (e: ChangeEvent<HTMLTextAreaElement | HTMLInputElement>) => void\n  label: string\n  onSend: (text: string) => void\n}\n\nfunction ChatSendPanel({ value, onChange, label, onSend }: ChatSendPanelProps) {\n  const classes = useStyles()\n\n  return (\n    <Box className={classes.box}>\n      <TextField\n        label={label}\n        fullWidth\n        multiline\n        rowsMax={4}\n        value={value}\n        onChange={onChange}\n        InputLabelProps={{\n          shrink: true,\n        }}\n      />\n      <IconButton color={'primary'} onClick={() => onSend(value)}>\n        <SendIcon />\n      </IconButton>\n    </Box>\n  )\n}\n\nexport default ChatSendPanel\n","import {ChangeEvent, useState} from \"react\";\n\nconst useTextField = (label: string, initialValue: string = '') => {\n  const [value, setValue] = useState<string>(initialValue);\n  const [error, setError] = useState<boolean>(false);\n\n  const onChange = (e: ChangeEvent<HTMLTextAreaElement | HTMLInputElement>) => {\n    setValue(e.target.value);\n    setError(false);\n  };\n\n  const empty = (): boolean => {\n    const trimValue = value.trim();\n    return trimValue === '' || trimValue === initialValue;\n  };\n\n  const alert = () => {\n    setError(true);\n    setValue(value.trim());\n    setTimeout(() => setError(false), 2000);\n  };\n\n  const clear = () => {\n    setValue('')\n  }\n\n  return {\n    bind: {\n      label,\n      value,\n      error,\n      onChange,\n    },\n    empty,\n    value: value.trim(),\n    alert,\n    clear,\n  };\n};\n\nexport default useTextField;","import {Box, Grid} from \"@material-ui/core\";\nimport {makeStyles, Theme} from \"@material-ui/core/styles\";\nimport ChatSendPanel from \"./ChatSendPanel\";\nimport useTextField from \"../hooks/useTextField\";\nimport React from \"react\"\n\nconst useStyles = makeStyles((theme: Theme) => ({\n  chat: {\n    display: 'flex',\n    flexDirection: 'column',\n    flex: '1',\n  },\n  messagesContainer: {\n    flex: '1',\n    display: 'flex',\n    flexDirection: 'column',\n    justifyContent: 'safe flex-start',\n    overflowX: 'hidden',\n    overflowY: 'auto',\n  }\n}));\n\ntype ChatProps = {\n  children?: React.ReactNode,\n  onSend: (text: string) => void,\n}\n\nexport function Chat({children, onSend}: ChatProps) {\n  const classes = useStyles();\n  const messageTextField = useTextField('Сообщение');\n\n  const send = (text: string) => {\n    onSend(text)\n    messageTextField.clear()\n  }\n\n  return (\n    <Box className={classes.chat}>\n      <Box className={classes.messagesContainer} m={2}>\n        <Grid container spacing={2}>\n          {children}\n        </Grid>\n      </Box>\n\n      <ChatSendPanel {...messageTextField.bind} onSend={send}/>\n    </Box>\n  );\n}","import { Grid, Typography } from '@material-ui/core'\n\ntype ChatMessageProps = {\n  name: string\n  text: string\n  time: string\n}\n\nfunction ChatMessage({ name, text, time }: ChatMessageProps) {\n  return (\n    <Grid item container direction={'column'}>\n      <Grid item container direction={'row'} justify={'space-between'}>\n        <Typography variant={'subtitle2'}>{name}</Typography>\n        <Typography variant={'caption'}>{time}</Typography>\n      </Grid>\n\n      <Grid item>{text}</Grid>\n    </Grid>\n  )\n}\n\nexport default ChatMessage\n","import React, { useState } from 'react'\nimport { makeStyles, Theme, createStyles } from '@material-ui/core/styles'\nimport CssBaseline from '@material-ui/core/CssBaseline'\nimport BottomPanel from '../components/BottomPanel'\nimport { PeerHook } from '../hooks/usePeer'\nimport { LocalVideo } from '../components/LocalVideo'\nimport { FullSizeVideo } from '../components/FullSizeVideo'\nimport { ChatPanel } from '../components/ChatPanel'\nimport { Chat } from '../components/Chat'\nimport ChatMessage from '../components/ChatMessage'\nimport { connect } from 'react-redux'\nimport { isAudioEnabled, isVideoEnabled } from '../redux/selectors'\nimport { useEffect } from 'react'\n\nconst useStyles = makeStyles((theme: Theme) =>\n  createStyles({\n    main: {\n      display: 'flex',\n      width: '100%',\n      height: '100%',\n    },\n    root: {\n      display: 'flex',\n      height: '100vh',\n      justifyContent: 'space-between',\n    },\n  })\n)\n\ntype MeetingPageProps = {\n  peer: PeerHook\n  localVideoRef: React.RefObject<HTMLVideoElement>\n  remoteVideoRef: React.RefObject<HTMLVideoElement>\n  audioEnabled: boolean\n  videoEnabled: boolean\n}\n\nfunction MeetingPage({\n  peer,\n  localVideoRef,\n  remoteVideoRef,\n  audioEnabled,\n  videoEnabled,\n}: MeetingPageProps) {\n  const classes = useStyles()\n  const [chatOpened, setChatOpened] = useState(false)\n\n  useEffect(() => {\n    peer.setAudio(audioEnabled)\n  }, [peer, audioEnabled])\n\n  useEffect(() => {\n    peer.setVideo(videoEnabled)\n  }, [peer, videoEnabled])\n\n  return (\n    <div className={classes.root}>\n      <CssBaseline />\n      <main className={classes.main}>\n        <LocalVideo ref={localVideoRef} />\n        <FullSizeVideo ref={remoteVideoRef} />\n      </main>\n\n      <ChatPanel open={chatOpened} onClose={() => setChatOpened(false)}>\n        <Chat onSend={(text) => peer.sendMessage(text)}>\n          {peer.messages.map((msg) => (\n            <ChatMessage\n              name={peer.id === msg.fromID ? 'Вы' : 'Собеседник'}\n              key={msg.id}\n              text={msg.text}\n              time={msg.time}\n            />\n          ))}\n        </Chat>\n      </ChatPanel>\n\n      <BottomPanel toggleChatOpened={() => setChatOpened(!chatOpened)} endCall={peer.endCall} />\n\n      {/*<Backdrop open={!meeting.connected}>*/}\n      {/*  <CircularProgress color=\"inherit\" />*/}\n      {/*</Backdrop>*/}\n    </div>\n  )\n}\n\nconst mapStateToProps = (state: any) => {\n  const audioEnabled = isAudioEnabled(state);\n  const videoEnabled = isVideoEnabled(state);\n\n  return {audioEnabled, videoEnabled};\n};\n\nexport default connect(mapStateToProps)(MeetingPage);","import { StartPage } from './pages/StartPage'\nimport MeetingPage from './pages/MeetingPage'\nimport { usePeer } from './hooks/usePeer'\nimport { useRef } from 'react'\n\nfunction App() {\n  const localVideoRef = useRef<HTMLVideoElement | null>(null)\n  const remoteVideoRef = useRef<HTMLVideoElement | null>(null)\n  const peer = usePeer(localVideoRef, remoteVideoRef)\n\n  return !peer.speaking ? (\n    <StartPage peer={peer} />\n  ) : (\n    <MeetingPage\n      peer={peer}\n      localVideoRef={localVideoRef}\n      remoteVideoRef={remoteVideoRef}\n    />\n  )\n}\n\nexport default App\n","import Peer, { DataConnection } from 'peerjs'\nimport { useEffect, useRef, useState } from 'react'\nimport { v4 as uuidv4 } from 'uuid'\n\nexport type PeerHook = {\n  id: string\n  callUser: (peerId: string) => Promise<boolean>\n  speaking: boolean\n  messages: Message[]\n  sendMessage: (text: string) => void\n  endCall: () => void\n  setAudio: (value: boolean) => void\n  setVideo: (value: boolean) => void\n}\n\ntype UsePeer = {\n  (\n    localVideoRef: React.RefObject<HTMLVideoElement>,\n    remoteVideoRef: React.RefObject<HTMLVideoElement>\n  ): PeerHook\n}\n\ntype Message = {\n  id: string\n  fromID: string\n  text: string\n  time: string\n}\n\nexport const usePeer: UsePeer = (localVideoRef, remoteVideoRef) => {\n  const peerRef = useRef<Peer>()\n  const connRef = useRef<DataConnection>()\n  const localStream = useRef<MediaStream>()\n\n  const [id, setId] = useState<string>('...')\n  const [speaking, setSpeaking] = useState(false)\n\n  const [messages, setMessages] = useState<Message[]>([])\n\n  useEffect(() => {\n    const generatedId = uuidv4()\n\n    setId(generatedId)\n\n    peerRef.current = new Peer(generatedId)\n\n    peerRef.current.on('connection', (conn) => {\n      connRef.current = conn\n\n      connRef.current.on('data', (data) => {\n        const msg: Message = data\n        setMessages((messages) => [...messages, msg])\n      })\n    })\n\n    peerRef.current.on('call', (call) => {\n      navigator.mediaDevices\n        .getUserMedia({ video: true, audio: true })\n        .then((stream) => {\n          localStream.current = stream\n\n          call.answer(stream)\n          call.on('stream', (remoteStream) => {\n            setSpeaking(true)\n\n            if (remoteVideoRef.current) {\n              remoteVideoRef.current.srcObject = remoteStream\n            }\n\n            if (localVideoRef.current) {\n              localVideoRef.current.srcObject = stream\n            }\n          })\n\n          call.on('close', () => {\n            setSpeaking(false)\n          })\n        })\n        .catch(() => {\n          setSpeaking(false)\n        })\n    })\n\n    return () => peerRef.current?.disconnect()\n  }, [localVideoRef, remoteVideoRef])\n\n  const callUser = (peerId: string) => {\n    return new Promise<boolean>((resolve, reject) => {\n      if (!peerRef.current) {\n        alert('Не удалось создать пир')\n        return\n      }\n\n      connRef.current = peerRef.current.connect(peerId)\n\n      if (!connRef.current) {\n        reject(new Error('Не удается начать звонок'))\n        return\n      }\n\n      connRef.current.on('data', (data) => {\n        const msg: Message = data\n        setMessages((messages) => [...messages, msg])\n      })\n\n      navigator.mediaDevices\n        .getUserMedia({ video: true, audio: true })\n        .then((stream) => {\n          localStream.current = stream\n\n          if (!peerRef.current) {\n            alert('Не удалось создать пир')\n            return\n          }\n\n          const call = peerRef.current.call(peerId, stream)\n\n          call.on('stream', (remoteStream) => {\n            setSpeaking(true)\n\n            if (remoteVideoRef.current) {\n              remoteVideoRef.current.srcObject = remoteStream\n            }\n\n            if (localVideoRef.current) {\n              localVideoRef.current.srcObject = stream\n            }\n\n            resolve(true)\n          })\n\n          call.on('close', () => {\n            setSpeaking(false)\n            reject(new Error('Соединение закрыто'))\n          })\n        })\n        .catch(() => {\n          setSpeaking(false)\n          reject(new Error('Разрешите доступ к устройствам'))\n        })\n    })\n  }\n\n  const sendMessage = (text: string) => {\n    const currentTime = () => {\n      const date = new Date()\n\n      let hours = date.getHours().toString()\n      let minutes = date.getMinutes().toString()\n\n      if (hours.length < 2) {\n        hours = '0' + hours\n      }\n\n      if (minutes.length < 2) {\n        minutes = '0' + minutes\n      }\n\n      return `${hours}:${minutes}`\n    }\n\n    const msg = {\n      id: uuidv4(),\n      fromID: id,\n      text,\n      time: currentTime(),\n    }\n\n    setMessages((messages) => [...messages, msg])\n\n    connRef.current?.send(msg)\n  }\n\n  const endCall = () => {\n    window.location.href = '/'\n  }\n\n  const setAudio = (value: boolean) => {\n    localStream.current?.getAudioTracks().forEach(track => track.enabled = value)\n  }\n\n  const setVideo = (value: boolean) => {\n    localStream.current?.getVideoTracks().forEach(track => track.enabled = value)\n  }\n\n  return {\n    id,\n    callUser,\n    speaking,\n    messages,\n    sendMessage,\n    endCall,\n    setAudio,\n    setVideo,\n  }\n}\n","import { ReportHandler } from 'web-vitals';\n\nconst reportWebVitals = (onPerfEntry?: ReportHandler) => {\n  if (onPerfEntry && onPerfEntry instanceof Function) {\n    import('web-vitals').then(({ getCLS, getFID, getFCP, getLCP, getTTFB }) => {\n      getCLS(onPerfEntry);\n      getFID(onPerfEntry);\n      getFCP(onPerfEntry);\n      getLCP(onPerfEntry);\n      getTTFB(onPerfEntry);\n    });\n  }\n};\n\nexport default reportWebVitals;\n","import {TOGGLE_AUDIO, TOGGLE_VIDEO} from \"../actionTypes\";\nimport {Action} from \"../actions\";\n\nconst initialState = {\n  audio: true,\n  video: true,\n};\n\ntype State = {\n  audio: boolean,\n  video: boolean,\n}\n\nfunction devices(state: State = initialState, action: Action) {\n  switch (action.type) {\n    case TOGGLE_AUDIO: {\n      return {\n        ...state,\n        audio: !state.audio,\n      };\n    }\n    case TOGGLE_VIDEO: {\n      return {\n        ...state,\n        video: !state.video,\n      };\n    }\n    default:\n      return state;\n  }\n}\n\nexport default devices;\n","import {SET_LOCAL_STREAM} from \"../actionTypes\"\nimport {Action} from \"../actions\";\n\nconst initialState = {\n  localStream: null,\n};\n\ntype State = {\n  localStream: MediaStream | null,\n}\n\nfunction stream(state: State = initialState, action: Action) {\n  switch (action.type) {\n    case SET_LOCAL_STREAM: {\n      return {\n        ...state,\n        localStream: action.payload,\n      };\n    }\n    default:\n      return state;\n  }\n}\n\nexport default stream;\n","import {combineReducers} from 'redux';\nimport devices from './devices';\nimport stream from \"./stream\"\n\nexport default combineReducers({devices, stream});","import {createStore} from 'redux';\nimport rootReducer from './reducers';\n\nconst store = createStore(rootReducer);\n\ndeclare global {\n  interface Window {\n    store: any;\n  }\n}\n\nwindow.store = store;\n\nexport default store;","import React from 'react'\nimport ReactDOM from 'react-dom'\nimport App from './App'\nimport reportWebVitals from './reportWebVitals'\n\nimport { Provider } from 'react-redux'\n\nimport store from './redux/store'\n\nReactDOM.render(\n  <Provider store={store}>\n    <React.StrictMode>\n      <App />\n    </React.StrictMode>\n  </Provider>,\n  document.getElementById('root')\n)\n\nreportWebVitals()\n"],"sourceRoot":""}