(this["webpackJsonpvideo-chat"]=this["webpackJsonpvideo-chat"]||[]).push([[0],{110:function(e,t){function n(e){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}n.keys=function(){return[]},n.resolve=n,e.exports=n,n.id=110},111:function(e,t,n){"use strict";n.r(t);var c=n(0),a=n.n(c),r=n(10),i=n.n(r),o=n(16),s=n(154),l=n(155),u=n(151),d=n(156),j=n(114),b=n(160),f=n(163),O=n(167),h=n(157),x=n(153),v=n(67),g=n.n(v),p=n(152),m=n(165),w=n(72),C=n.n(w),y=n(73),E=n.n(y),k=n(2),S=function(e){var t=e.text,n=Object(c.useState)(!1),a=Object(o.a)(n,2),r=a[0],i=a[1],s=function(){i(!1)};return Object(k.jsxs)(k.Fragment,{children:[Object(k.jsx)(b.a,{type:"text",value:t,fullWidth:!0,disabled:!0,InputProps:{endAdornment:Object(k.jsx)(p.a,{position:"end",children:Object(k.jsx)(f.a,{"aria-label":"copy to clipboard",onClick:function(){g()(t),i(!0)},edge:"end",children:Object(k.jsx)(C.a,{})})})}}),Object(k.jsx)(m.a,{open:r,autoHideDuration:3e3,onClose:s,anchorOrigin:{vertical:"bottom",horizontal:"center"},message:"\u0421\u043a\u043e\u043f\u0438\u0440\u043e\u0432\u0430\u043d\u043e",action:Object(k.jsx)(f.a,{size:"small","aria-label":"close",color:"inherit",onClick:s,children:Object(k.jsx)(E.a,{fontSize:"small"})})})]})},M=n(74),D=n.n(M),N=Object(x.a)((function(e){return{container:{height:"100vh",display:"flex",alignItems:"center",justifyContent:"center"},paper:{padding:e.spacing(5),marginTop:-e.spacing(20)},backdrop:{zIndex:e.zIndex.drawer+1,color:"#fff",display:"flex",flexDirection:"column"}}}));function I(e){var t=e.peer,n=N(),a=Object(c.useState)(!1),r=Object(o.a)(a,2),i=r[0],x=r[1],v=Object(c.useState)(""),g=Object(o.a)(v,2),p=g[0],m=g[1];return Object(k.jsxs)(k.Fragment,{children:[Object(k.jsx)(s.a,{}),Object(k.jsxs)(l.a,{maxWidth:"sm",className:n.container,children:[Object(k.jsx)(u.a,{className:n.paper,variant:"outlined",children:Object(k.jsxs)(d.a,{container:!0,spacing:2,direction:"column",children:[Object(k.jsxs)(d.a,{item:!0,children:[Object(k.jsx)(j.a,{variant:"h5",gutterBottom:!0,children:"\u041d\u0430\u0447\u043d\u0438\u0442\u0435 \u0437\u0432\u043e\u043d\u043e\u043a"}),Object(k.jsx)(b.a,{value:p,onChange:function(e){var t=e.target.value.replaceAll(" ","");m(t)},label:"ID \u0441\u043e\u0431\u0435\u0441\u0435\u0434\u043d\u0438\u043a\u0430"}),Object(k.jsx)(f.a,{color:"primary",onClick:function(){x(!0),t.callUser(p).catch((function(e){return alert(e)})).finally((function(){return x(!1)}))},children:Object(k.jsx)(D.a,{})})]}),Object(k.jsxs)(d.a,{item:!0,children:[Object(k.jsxs)(j.a,{variant:"overline",display:"block",gutterBottom:!0,children:["\u0438\u043b\u0438 \u043f\u043e\u0434\u0435\u043b\u0438\u0442\u0435\u0441\u044c \u0441\u0432\u043e\u0438\u043c ",Object(k.jsx)("b",{children:"ID"})]}),Object(k.jsx)(S,{text:t.id})]})]})}),Object(k.jsxs)(O.a,{className:n.backdrop,open:i,onClick:function(){t.endCall(),x(!1)},children:[Object(k.jsx)(h.a,{color:"inherit"}),Object(k.jsx)(j.a,{children:"\u0417\u0432\u043e\u043d\u0438\u043c..."})]})]})]})}var R=n(166),T=n(158),A=n(159);function V(e){var t=e.iconOn,n=e.iconOff,a=e.initialValue,r=e.toggle,i=Object(c.useState)(a),s=Object(o.a)(i,2),l=s[0],u=s[1];return Object(k.jsx)(f.a,{color:l?"primary":"secondary",onClick:function(){u(!l),r()},children:l?t:n})}var B=n(76),P=n.n(B),L=n(77),_=n.n(L),F=n(78),G=n.n(F),H=n(79),U=n.n(H),z=n(81),W=n.n(z),J=n(80),X=n.n(J),Y=function(e){return e.devices},q=function(e){return e.chat},K=function(e){var t=Y(e);return!!t&&t.audio},Q=function(e){var t=Y(e);return!!t&&t.video},Z="TOGGLE_MICRO",$="TOGGLE_VIDEO",ee="OPEN_CHAT",te="CLOSE_CHAT",ne="ENABLE_MSG_BADGE",ce="DISABLE_MSG_BADGE",ae=function(){return{type:Z}},re=function(){return{type:$}},ie=n(42),oe=Object(x.a)((function(e){return{panel:{position:"absolute",bottom:"15px",background:"white",borderRadius:"7px",width:"auto",margin:"auto"}}}));var se=Object(ie.b)((function(e){return{audioEnabled:K(e),videoEnabled:Q(e),toggleAudio:ae,toggleVideo:re}}),(function(e){return{toggleAudio:function(){return e(ae())},toggleVideo:function(){return e(re())}}}))((function(e){var t=e.toggleChatOpened,n=e.audioEnabled,c=e.videoEnabled,a=e.toggleAudio,r=e.toggleVideo,i=e.endCall,o=e.newMessages,s=oe();return Object(k.jsxs)(d.a,{className:s.panel,item:!0,container:!0,children:[Object(k.jsx)(V,{iconOn:Object(k.jsx)(P.a,{}),iconOff:Object(k.jsx)(_.a,{}),initialValue:n,toggle:a}),Object(k.jsx)(V,{iconOn:Object(k.jsx)(G.a,{}),iconOff:Object(k.jsx)(U.a,{}),initialValue:c,toggle:r}),Object(k.jsx)(T.a,{orientation:"vertical",flexItem:!0}),Object(k.jsx)(f.a,{color:"secondary",onClick:i,children:Object(k.jsx)(X.a,{})}),Object(k.jsx)(f.a,{color:"default",onClick:t,children:Object(k.jsx)(A.a,{color:"secondary",variant:"dot",invisible:!o,children:Object(k.jsx)(W.a,{})})})]})})),le=n(11),ue=Object(x.a)((function(e){return{video:{width:"200px",position:"absolute",top:"15px",left:"15px",objectFit:"cover",backgroundColor:"#263238",borderRadius:"10px",boxShadow:"0 0 15px 5px #151515"}}})),de=a.a.forwardRef((function(e,t){var n=ue();return Object(k.jsx)("video",Object(le.a)(Object(le.a)({},e),{},{muted:!0,ref:t,autoPlay:!0,className:n.video}))})),je=Object(x.a)((function(e){return{video:{width:"100%",height:"auto",maxHeight:"100%"}}})),be=a.a.forwardRef((function(e,t){var n=je();return Object(k.jsx)("video",Object(le.a)(Object(le.a)({},e),{},{ref:t,autoPlay:!0,className:n.video}))})),fe=n(86),Oe=n(82),he=n.n(Oe),xe=n(83),ve=n.n(xe),ge=n(168),pe=n(161),me=n(21);function we(e){var t=e.children,n=e.value,c=e.index,a=Object(fe.a)(e,["children","value","index"]);return Object(k.jsx)("div",Object(le.a)(Object(le.a)({role:"tabpanel",hidden:n!==c,id:"simple-tabpanel-".concat(c),"aria-labelledby":"simple-tab-".concat(c)},a),{},{children:n===c&&t}))}var Ce=Object(x.a)((function(e){return{drawer:{width:310,flexShrink:0},drawerPaper:{width:310,overflow:"hidden"},drawerHeader:Object(le.a)(Object(le.a)({display:"flex",alignItems:"center",padding:e.spacing(0,1)},e.mixins.toolbar),{},{justifyContent:"flex-start"}),chatTabPanel:{display:"flex",flex:"1",overflow:"hidden"}}}));function ye(e){var t=e.open,n=e.onClose,c=e.children,a=Ce(),r=Object(me.a)();return Object(k.jsxs)(ge.a,{className:a.drawer,anchor:"right",open:t,onClose:n,classes:{paper:a.drawerPaper},children:[Object(k.jsxs)(pe.a,{children:[Object(k.jsx)("div",{className:a.drawerHeader,children:Object(k.jsx)(f.a,{onClick:n,children:"rtl"===r.direction?Object(k.jsx)(he.a,{}):Object(k.jsx)(ve.a,{})})}),Object(k.jsx)(T.a,{})]}),Object(k.jsx)(we,{value:0,index:0,className:a.chatTabPanel,children:c})]})}var Ee=n(84),ke=n.n(Ee),Se=Object(x.a)((function(e){return{box:{display:"flex",backgroundColor:"white",borderTop:"1px solid #eaeaea",width:"100%",paddingLeft:e.spacing(2),paddingTop:e.spacing(1),paddingBottom:e.spacing(1),paddingRight:e.spacing(1)}}}));var Me=function(e){var t=e.value,n=e.onChange,c=e.label,a=e.onSend,r=Se();return Object(k.jsxs)(pe.a,{className:r.box,children:[Object(k.jsx)(b.a,{label:c,fullWidth:!0,multiline:!0,rowsMax:4,value:t,onChange:n,InputLabelProps:{shrink:!0}}),Object(k.jsx)(f.a,{color:"primary",onClick:function(){return a(t)},children:Object(k.jsx)(ke.a,{})})]})},De=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",n=Object(c.useState)(t),a=Object(o.a)(n,2),r=a[0],i=a[1],s=Object(c.useState)(!1),l=Object(o.a)(s,2),u=l[0],d=l[1],j=function(e){i(e.target.value),d(!1)},b=function(){var e=r.trim();return""===e||e===t},f=function(){d(!0),i(r.trim()),setTimeout((function(){return d(!1)}),2e3)},O=function(){i("")};return{bind:{label:e,value:r,error:u,onChange:j},empty:b,value:r.trim(),alert:f,clear:O}},Ne=Object(x.a)((function(e){return{chat:{display:"flex",flexDirection:"column",flex:"1"},messagesContainer:{flex:"1",display:"flex",flexDirection:"column",justifyContent:"safe flex-start",overflowX:"hidden",overflowY:"auto"}}}));function Ie(e){var t=e.children,n=e.onSend,c=Ne(),a=De("\u0421\u043e\u043e\u0431\u0449\u0435\u043d\u0438\u0435");return Object(k.jsxs)(pe.a,{className:c.chat,children:[Object(k.jsx)(pe.a,{className:c.messagesContainer,m:2,children:Object(k.jsx)(d.a,{container:!0,spacing:2,children:t})}),Object(k.jsx)(Me,Object(le.a)(Object(le.a)({},a.bind),{},{onSend:function(e){n(e),a.clear()}}))]})}var Re=function(e){var t=e.name,n=e.text,c=e.time;return Object(k.jsxs)(d.a,{item:!0,container:!0,direction:"column",children:[Object(k.jsxs)(d.a,{item:!0,container:!0,direction:"row",justify:"space-between",children:[Object(k.jsx)(j.a,{variant:"subtitle2",children:t}),Object(k.jsx)(j.a,{variant:"caption",children:c})]}),Object(k.jsx)(d.a,{item:!0,children:n})]})},Te=Object(x.a)((function(e){return Object(R.a)({main:{display:"flex",width:"100%",height:"100%",backgroundColor:"#171717"},root:{display:"flex",flexDirection:"column",height:"100vh",alignItems:"center"}})}));var Ae=Object(ie.b)((function(e){return{audioEnabled:K(e),videoEnabled:Q(e),chatOpened:function(e){var t=q(e);return!!t&&t.chatOpened}(e),newMessages:function(e){var t=q(e);return!!t&&t.newMessages}(e)}}),(function(e){return{openChat:function(){return e({type:ee})},closeChat:function(){return e({type:te})},enableMsgBadge:function(t){return e(function(e){return{type:ne,payload:e}}(t))},disableMsgBadge:function(){return e({type:ce})}}}))((function(e){var t=e.peer,n=e.localVideoRef,a=e.remoteVideoRef,r=e.audioEnabled,i=e.videoEnabled,o=e.chatOpened,l=e.newMessages,u=e.openChat,d=e.closeChat,j=e.enableMsgBadge,b=e.disableMsgBadge,f=Te();return Object(c.useEffect)((function(){t.setAudio(r)}),[t,r]),Object(c.useEffect)((function(){t.setVideo(i)}),[t,i]),Object(c.useEffect)((function(){j(0!==t.messages.length)}),[t.messages]),Object(k.jsxs)("div",{className:f.root,children:[Object(k.jsx)(s.a,{}),Object(k.jsxs)("main",{className:f.main,children:[Object(k.jsx)(de,{ref:n}),Object(k.jsx)(be,{ref:a})]}),Object(k.jsx)(ye,{open:o,onClose:d,children:Object(k.jsx)(Ie,{onSend:function(e){return t.sendMessage(e)},children:t.messages.map((function(e){return Object(k.jsx)(Re,{name:t.id===e.fromID?"\u0412\u044b":"\u0421\u043e\u0431\u0435\u0441\u0435\u0434\u043d\u0438\u043a",text:e.text,time:e.time},e.id)}))})}),Object(k.jsx)(se,{toggleChatOpened:function(){u(),b()},endCall:t.endCall,newMessages:l})]})})),Ve=n(57),Be=n(85),Pe=n.n(Be),Le=n(164);var _e=function(){var e=Object(c.useRef)(null),t=Object(c.useRef)(null),n=function(e,t){var n=Object(c.useRef)(null),a=Object(c.useRef)(null),r=Object(c.useRef)(null),i=Object(c.useState)("..."),s=Object(o.a)(i,2),l=s[0],u=s[1],d=Object(c.useState)(!1),j=Object(o.a)(d,2),b=j[0],f=j[1],O=Object(c.useState)([]),h=Object(o.a)(O,2),x=h[0],v=h[1];Object(c.useEffect)((function(){var c=Object(Le.a)();return u(c),n.current=new Pe.a(c),n.current.on("connection",(function(e){a.current=e,a.current.on("data",(function(e){var t=e;v((function(e){return[].concat(Object(Ve.a)(e),[t])}))}))})),n.current.on("call",(function(n){navigator.mediaDevices.getUserMedia({video:!0,audio:!0}).then((function(c){r.current=c,n.answer(c),n.on("stream",(function(n){f(!0),t.current&&(t.current.srcObject=n),e.current&&(e.current.srcObject=c)})),n.on("close",(function(){g()}))})).catch((function(){g()}))})),function(){var e;return null===(e=n.current)||void 0===e?void 0:e.disconnect()}}),[e,t]);var g=function(){var e,t;null===(e=a.current)||void 0===e||e.close(),null===(t=n.current)||void 0===t||t.disconnect(),window.location.reload()};return{id:l,callUser:function(c){return new Promise((function(i,o){n.current?(a.current=n.current.connect(c),a.current?(a.current.on("data",(function(e){var t=e;v((function(e){return[].concat(Object(Ve.a)(e),[t])}))})),navigator.mediaDevices.getUserMedia({video:!0,audio:!0}).then((function(a){if(r.current=a,n.current){var o=n.current.call(c,a);o.on("stream",(function(n){f(!0),t.current&&(t.current.srcObject=n),e.current&&(e.current.srcObject=a),i(!0)})),o.on("close",(function(){g()}))}else alert("\u041d\u0435 \u0443\u0434\u0430\u043b\u043e\u0441\u044c \u0441\u043e\u0437\u0434\u0430\u0442\u044c \u043f\u0438\u0440")})).catch((function(){f(!1),o(new Error("\u0420\u0430\u0437\u0440\u0435\u0448\u0438\u0442\u0435 \u0434\u043e\u0441\u0442\u0443\u043f \u043a \u0443\u0441\u0442\u0440\u043e\u0439\u0441\u0442\u0432\u0430\u043c"))}))):o(new Error("\u041d\u0435 \u0443\u0434\u0430\u0435\u0442\u0441\u044f \u043d\u0430\u0447\u0430\u0442\u044c \u0437\u0432\u043e\u043d\u043e\u043a, \u043e\u0431\u043d\u043e\u0432\u0438\u0442\u0435 \u0441\u0442\u0440\u0430\u043d\u0438\u0446\u0443"))):alert("\u041d\u0435 \u0443\u0434\u0430\u043b\u043e\u0441\u044c \u0441\u043e\u0437\u0434\u0430\u0442\u044c \u043f\u0438\u0440")}))},speaking:b,messages:x,sendMessage:function(e){var t,n={id:Object(Le.a)(),fromID:l,text:e,time:function(){var e=new Date,t=e.getHours().toString(),n=e.getMinutes().toString();return t.length<2&&(t="0"+t),n.length<2&&(n="0"+n),"".concat(t,":").concat(n)}()};v((function(e){return[].concat(Object(Ve.a)(e),[n])})),null===(t=a.current)||void 0===t||t.send(n)},endCall:g,setAudio:function(e){var t;null===(t=r.current)||void 0===t||t.getAudioTracks().forEach((function(t){return t.enabled=e}))},setVideo:function(e){var t;null===(t=r.current)||void 0===t||t.getVideoTracks().forEach((function(t){return t.enabled=e}))}}}(e,t);return n.speaking?Object(k.jsx)(Ae,{peer:n,localVideoRef:e,remoteVideoRef:t}):Object(k.jsx)(I,{peer:n})},Fe=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,170)).then((function(t){var n=t.getCLS,c=t.getFID,a=t.getFCP,r=t.getLCP,i=t.getTTFB;n(e),c(e),a(e),r(e),i(e)}))},Ge=n(41),He={audio:!0,video:!0};var Ue={chatOpened:!1,newMessages:!1};var ze=Object(Ge.b)({devices:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:He,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case Z:return Object(le.a)(Object(le.a)({},e),{},{audio:!e.audio});case $:return Object(le.a)(Object(le.a)({},e),{},{video:!e.video});default:return e}},chat:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Ue,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case ee:return Object(le.a)(Object(le.a)({},e),{},{chatOpened:!0});case te:return Object(le.a)(Object(le.a)({},e),{},{chatOpened:!1});case ne:return Object(le.a)(Object(le.a)({},e),{},{newMessages:!e.chatOpened&&t.payload});case ce:return Object(le.a)(Object(le.a)({},e),{},{newMessages:!1});default:return e}}}),We=Object(Ge.c)(ze);window.store=We;var Je=We;i.a.render(Object(k.jsx)(ie.a,{store:Je,children:Object(k.jsx)(a.a.StrictMode,{children:Object(k.jsx)(_e,{})})}),document.getElementById("root")),Fe()}},[[111,1,2]]]);
//# sourceMappingURL=main.74745761.chunk.js.map